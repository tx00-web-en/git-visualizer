(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function i(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=i(n);fetch(n.href,s)}})();const C=typeof window<"u"&&window.d3||globalThis.d3;var J="url(#triangle)",q="url(#brown-triangle)",L="url(#faded-triangle)",G,A,W,S,V,R,B,P,O,_,T,M,x,N;G=function t(e,i){for(var r=i.commitData,n=i.baseLine,s=i.commitRadius*4.5,o=null,a=0;a<r.length;a++){var c=r[a];if(c.cx===e.cx&&c.cy===e.cy&&c!==e){o=c;break}}if(o){var h=i.getCommit(o.parent),f=i.getCommit(e.parent);o.cy<n?(o=h.cy<f.cy?o:e,o.cy-=s):(o=h.cy>f.cy?o:e,o.cy+=s),t(o,i)}};A=function(t){t.empty()||(t.classed("branchless",function(e){return e.branchless}),t.classed("commit-pointer")?t.attr("marker-end",function(e){return e.branchless?L:J}):t.classed("merge-pointer")&&t.attr("marker-end",function(e){return e.branchless?L:q}))};W=function(t,e){var i=e.getCommit(t.parent),r=i.cx;if(typeof t.parent2=="string"){var n=e.getCommit(t.parent2);r=i.cx>n.cx?i.cx:n.cx}return r+e.commitRadius*4.5};S=function(t,e){for(var i=e.getCommit(t.parent),r=i.cy||S(i,e),n=e.baseLine,s=e.commitRadius*4.5,o=[],a=0,c=0;c<e.commitData.length;c++){var h=e.commitData[c];h.parent===t.parent&&o.push(h.id)}if(a=o.indexOf(t.id),t.isNoFFBranch===!0&&a++,t.isNoFFCommit===!0&&a--,r===n){for(var f=1,l=0;l<a;l++)f*=-1;return s*=Math.ceil(a/2),r+s*f}if(r<n)return r-s*a;if(r>n)return r+s*a};V=function(t){t.attr("cx",function(e){return e.cx}).attr("cy",function(e){return e.cy})};R=function(t,e,i){i=i||"parent";var r=e.getCommit(t[i]),n=t.cx,s=n-r.cx,o=r.cy-t.cy,a=Math.sqrt(s*s+o*o);return n-e.pointerMargin*(s/a)};B=function(t,e,i){i=i||"parent";var r=e.getCommit(t[i]),n=t.cy,s=t.cx-r.cx,o=r.cy-n,a=Math.sqrt(s*s+o*o);return n+e.pointerMargin*(o/a)};P=function(t,e){t.attr("x1",function(i){return R(i,e)}).attr("y1",function(i){return B(i,e)})};O=function(t,e,i){i=i||"parent";var r=e.getCommit(t[i]),n=r.cx,s=t.cx-n,o=r.cy-t.cy,a=Math.sqrt(s*s+o*o);return n+e.pointerMargin*1.2*(s/a)};_=function(t,e,i){i=i||"parent";var r=e.getCommit(t[i]),n=r.cy,s=t.cx-r.cx,o=n-t.cy,a=Math.sqrt(s*s+o*o);return n-e.pointerMargin*1.2*(o/a)};T=function(t,e){t.attr("x2",function(i){return O(i,e)}).attr("y2",function(i){return _(i,e)})};M=function(t,e,i){t.attr("x",function(r){return r.cx}).attr("y",function(r){return r.cy+e.commitRadius+i})};x=function(e,i){var r=i.getCommit(e.commit),n=r.cy,s=r.tags,o=s.indexOf(e.name);return o===-1&&(o=s.length),n<i.baseLine?n-45-o*25:n+50+o*25};N=function(t,e){var i=JSON.parse(JSON.stringify(t)),r=JSON.parse(JSON.stringify(e));for(var n in t)delete r[n];for(var n in e)delete i[n];return[i,r]};function H(t){var e=t.commitData||[],i,r;this.branches=[];for(var n=0;n<e.length;n++){i=e[n],!i.parent&&(i.parent="initial"),!i.tags&&(i.tags=[]);for(var s=0;s<i.tags.length;s++)r=i.tags[s],r.indexOf("[")!==0&&this.branches.indexOf(r)===-1&&this.branches.push(r)}this.name=t.name||"UnnamedHistoryView",this.commitData=e,this.currentBranch=t.currentBranch||"main",this.width=t.width,this.height=t.height||400,this.orginalBaseLine=t.baseLine,this.baseLine=this.height*(t.baseLine||.9),this.commitRadius=t.commitRadius||20,this.pointerMargin=this.commitRadius*1.3,this.isRemote=typeof t.remoteName=="string",this.remoteName=t.remoteName,this.logs={},this.initialCommit={id:"initial",parent:null,cx:-(this.commitRadius*2),cy:this.baseLine},this.locks=0,this._eventCallbacks={},t.savedState&&setTimeout((function(){this.deserialize(t.savedState)}).bind(this))}H.generateId=function(){return Math.floor((1+Math.random())*268435456).toString(16).substring(1)};H.prototype={serialize:function(){var t={commitData:this.commitData,branches:this.branches,logs:this.logs,currentBranch:this.currentBranch};return JSON.stringify(t)},deserialize:function(t){t=JSON.parse(t),t&&(this.commitData=t.commitData,this.branches=t.branches,this.logs=t.logs,this._setCurrentBranch(t.currentBranch||null),this.renderCommits(),this.renderTags())},emit:function(t){var e=this._eventCallbacks[t]||[];e.forEach(function(i){try{i(t)}finally{}})},on:function(t,e){var i=this._eventCallbacks[t]||[];return i.push(e),this._eventCallbacks[t]=i,(function(){var r=this._eventCallbacks[t]||[],n=r.indexOf(e);n>-1&&(r.splice(n,1),this._eventCallbacks[t]=r)}).bind(this)},lock:function(){this.locks++,this.locks===1&&this.emit("lock")},unlock:function(){if(this.locks<=0)throw new Error("cannot unlock! not locked");this.locks--,this.locks===0&&this.emit("unlock")},getCommit:function(h){if(!h)return null;if(h.id)return h;var i=this.commitData,r=null,n;if(n=h.match(/^(.*)@\{(\d+)\}(.*)$/)){var s=n[1].toLowerCase(),o=parseInt(n[2],10),a=n[3];this.logs[s]&&this.logs[s][o]&&(h=this.logs[s][o].destination+a)}var c=/^([^\^\~]+)(.*)$/.exec(h),h=c[1],f=c[2];if(h==="initial")return this.initialCommit;h.toLowerCase()==="head"&&(h="HEAD");var l=i.filter(function(u){return u.id.indexOf(h)===0});if(l.length===1)r=l[0];else if(l.length>1)throw new Error("Ref "+h+" is ambiguous");for(var d=0;d<i.length;d++){var p=i[d];if(p===h){r=p;break}if(p.id===h){r=p;break}var m=function(){for(var u=0;u<p.tags.length;u++){var w=p.tags[u];if(w===h||(w.indexOf("[")===0&&w.indexOf("]")===w.length-1&&(w=w.substring(1,w.length-1)),w===h))return r=p,!0}}();if(m===!0)break}if(r&&f)for(;f;){var v=f[0];f=f.substr(1);var y=f.match(/^(\d+)(.*)$/),g=1;if(y)var g=~~y[1];if(v==="^")g===0||(g===1?r=this.getCommit(r.parent):g===2?r=this.getCommit(r.parent2):r=null);else if(v==="~")for(var d=0;d<g;d++)r&&r.parent&&(r=this.getCommit(r.parent))}return r},revparse:function(t){var e;if(e=this.getCommit(t))return e.id;throw new Error("Cannot find object from refspec "+t)},getCircle:function(t){var e=this.svg.select("#"+this.name+"-"+t),i;return e&&!e.empty()?e:(i=this.getCommit(t),i?this.svg.select("#"+this.name+"-"+i.id):null)},getCircles:function(){return this.svg.selectAll("circle.commit")},render:function(t){var e,i;e=t.append("div").classed("svg-container",!0).classed("remote-container",this.isRemote),this.isRemote&&$(e).draggable(),i=e.append("svg:svg"),i.attr("id",this.name).attr("width",this.width).attr("height",this.isRemote?this.height+150:this.height),this.isRemote?i.append("svg:text").classed("remote-name-display",!0).text(this.remoteName).attr("x",10).attr("y",25):(i.append("svg:text").classed("remote-name-display",!0).text("Local Repository").attr("x",10).attr("y",25),i.append("svg:text").classed("current-branch-display",!0).attr("x",10).attr("y",45)),this.svgContainer=e,this.svg=i,this.arrowBox=i.append("svg:g").classed("pointers",!0),this.commitBox=i.append("svg:g").classed("commits",!0),this.tagBox=i.append("svg:g").classed("tags",!0),this.renderCommits(),this._setCurrentBranch(this.currentBranch)},destroy:function(){this.svg.remove(),this.svgContainer.remove(),clearInterval(this.refreshSizeTimer);for(var t in this)this.hasOwnProperty(t)&&(this[t]=null)},_calculatePositionData:function(){for(var t=0;t<this.commitData.length;t++){var e=this.commitData[t];e.cx=W(e,this),e.cy=S(e,this),G(e,this)}},_resizeSvg:function(){var t=document.getElementById(this.svg.node().id),e=t.parentNode,i=t.offsetWidth,r;t.getBBox().width>e.offsetWidth?r=Math.round(t.getBBox().width):r=e.offsetWidth-5,i!=r&&(this.svg.attr("width",r),e.scrollLeft=e.scrollWidth)},renderCommits:function(){if(typeof this.height=="string"&&this.height.indexOf("%")>=0){var t=this.height.substring(0,this.height.length-1)/100,e=Math.round(this.svg.node().parentNode.offsetHeight*t)-65,i=Math.round(e*(this.originalBaseLine||.6));i!==this.baseLine&&(this.baseLine=i,this.initialCommit.cy=i,this.svg.attr("height",e))}this._calculatePositionData(),this._calculatePositionData(),this._renderCircles(),this._renderPointers(),this._renderMergePointers(),this._renderIdLabels(),this._resizeSvg(),this.currentBranch&&this.checkout(this.currentBranch)},_renderCircles:function(){var t=this,e;e=this.commitBox.selectAll("circle.commit").data(this.commitData,function(i){return i.id}).attr("id",function(i){return t.name+"-"+i.id}).classed("reverted",function(i){return i.reverted||i.revertSource}).classed("rebased",function(i){return i.rebased||i.rebaseSource}).classed("logging",function(i){return i.logging}).classed("cherry-picked",function(i){return i.cherryPicked||i.cherryPickSource}).classed("checked-out",function(i){return i.tags.indexOf("HEAD")>-1}),e.transition().duration(500).call(V),e.enter().append("svg:circle").attr("id",function(i){return t.name+"-"+i.id}).classed("commit",!0).classed("merge-commit",function(i){return typeof i.parent2=="string"}).classed("rebased",function(i){return i.rebased||i.rebaseSource}).classed("cherry-picked",function(i){return i.cherryPicked||i.cherryPickSource}).call(V).attr("r",1).transition("inflate").duration(500).attr("r",this.commitRadius),e.exit().remove()},_renderPointers:function(){var t=this,e;e=this.arrowBox.selectAll("line.commit-pointer").data(this.commitData,function(i){return i.id}).attr("id",function(i){return t.name+"-"+i.id+"-to-"+i.parent}),e.transition().duration(500).call(P,t).call(T,t),e.enter().append("svg:line").attr("id",function(i){return t.name+"-"+i.id+"-to-"+i.parent}).classed("commit-pointer",!0).call(P,t).attr("x2",function(){return C.select(this).attr("x1")}).attr("y2",function(){return C.select(this).attr("y1")}).attr("marker-end",J).transition().duration(500).call(T,t),e.exit().remove()},_renderMergePointers:function(){for(var t=this,e=[],i,r=0;r<this.commitData.length;r++){var n=this.commitData[r];typeof n.parent2=="string"&&e.push(n)}i=this.arrowBox.selectAll("polyline.merge-pointer").data(e,function(s){return s.id}).attr("id",function(s){return t.name+"-"+s.id+"-to-"+s.parent2}),i.transition().duration(500).attr("points",function(s){var o=R(s,t,"parent2")+","+B(s,t,"parent2"),a=O(s,t,"parent2")+","+_(s,t,"parent2");return[o,a].join(" ")}),i.enter().append("svg:polyline").attr("id",function(s){return t.name+"-"+s.id+"-to-"+s.parent2}).classed("merge-pointer",!0).attr("points",function(s){var o=R(s,t,"parent2"),a=B(s,t,"parent2"),c=o+","+a;return[c,c].join(" ")}).attr("marker-end",q).transition().duration(500).attr("points",function(s){var o=C.select(this).attr("points").split(" "),a=O(s,t,"parent2"),c=_(s,t,"parent2");return o[1]=a+","+c,o.join(" ")}),i.exit().remove()},_renderIdLabels:function(){this._renderText("id-label",function(t){return t.id+".."},14),this._renderText("message-label",function(t){return t.message},24)},_renderText:function(t,e,i){var r=this,n;n=this.commitBox.selectAll("text."+t).data(this.commitData,function(s){return s.id}).text(e),n.transition().call(M,r,i),n.enter().insert("svg:text",":first-child").classed(t,!0).text(e).call(M,r,i),n.exit().remove()},_parseTagData:function(){var t=[],e,i=null;for(e=0;e<this.commitData.length;e++)for(var r=this.commitData[e],n=0;n<r.tags.length;n++){var s=r.tags[n];s.toUpperCase()==="HEAD"?i=r:this.branches.indexOf(s)===-1&&this.branches.push(s),t.push({name:s,commit:r.id})}return i||(i=this.getCommit(this.currentBranch),i.tags.push("HEAD"),t.push({name:"HEAD",commit:i.id})),t},_walkCommit:function(t){t.branchless=!1,t.parent&&this._walkCommit(this.getCommit(t.parent)),t.parent2&&this._walkCommit(this.getCommit(t.parent2))},_markBranchlessCommits:function(){var t,e,i,r;for(i=0;i<this.commitData.length;i++)this.commitData[i].branchless=!0;for(r=0;r<this.branches.length;r++)t=this.branches[r],t.indexOf("/")===-1&&(e=this.getCommit(t),this.getCommit(e.parent),this.getCommit(e.parent2),this._walkCommit(e));this.svg.selectAll("circle.commit").call(A),this.svg.selectAll("line.commit-pointer").call(A),this.svg.selectAll("polyline.merge-pointer").call(A)},renderTags:function(){var t=this,e=this._parseTagData(),i,r;i=this.tagBox.selectAll("g.branch-tag").data(e,function(n){return n.name}),i.exit().remove(),i.select("rect").transition().duration(500).attr("y",function(n){return x(n,t)}).attr("x",function(n){var s=t.getCommit(n.commit),o=Number(C.select(this).attr("width"));return s.cx-o/2}),i.select("text").transition().duration(500).attr("y",function(n){return x(n,t)+14}).attr("x",function(n){var s=t.getCommit(n.commit);return s.cx}),r=i.enter().append("g").attr("class",function(n){var s="branch-tag";return n.name.indexOf("[")===0&&n.name.indexOf("]")===n.name.length-1?s+=" git-tag":n.name.indexOf("/")>=0?s+=" remote-branch":n.name.toUpperCase()==="HEAD"&&(s+=" head-tag"),s}),r.append("svg:rect").attr("width",function(n){return n.name.length*8+20}).attr("height",20).attr("y",function(n){return x(n,t)}).attr("x",function(n){var s=t.getCommit(n.commit),o=Number(C.select(this).attr("width"));return s.cx-o/2}),r.append("svg:text").text(function(n){return n.name.indexOf("[")===0&&n.name.indexOf("]")===n.name.length-1?n.name.substring(1,n.name.length-1):n.name}).attr("y",function(n){return x(n,t)+14}).attr("x",function(n){var s=t.getCommit(n.commit);return s.cx}),i.exit().remove(),this._markBranchlessCommits()},_setCurrentBranch:function(t){var e=this.svg.select("text.current-branch-display"),i="HEAD: ";t&&t.indexOf("/")===-1?(i+=t,this.currentBranch=t):(i+=" (detached head)",this.currentBranch=null),e.text(i)},addReflogEntry:function(t,e,i){t=t.toLowerCase(),this.logs[t]=this.logs[t]||[],this.logs[t].unshift({destination:e,reason:i})},getReflogEntries:function(t){if(!this.logs[t.toLowerCase()])throw new Error("no reflog for "+t);return this.logs[t.toLowerCase()].map(function(e,i){return e.destination+" "+t+"@{"+i+"}  "+e.reason})},moveTag:function(t,e){var i=this.getCommit(t),r=this.getCommit(e);return i&&i.tags.splice(i.tags.indexOf(t),1),r.tags.push(t),this},amendCommit:function(t){this.commit({parent:this.getCommit("head^").id},t)},commit:function(t,e){return t=t||{},!t.id&&(t.id=H.generateId()),!t.tags&&(t.tags=[]),t.message=e,t.parent||(t.parent=this.getCommit("HEAD").id),this.commitData.push(t),this.currentBranch&&this.moveTag(this.currentBranch,t.id),this.renderCommits(),this.currentBranch?this.checkout(this.currentBranch):this.checkout(t.id),this},getLogEntries:function(t){var e=this.getAncestorSet(t);delete e.initial,e[t]=-1;var i=Object.keys(e);return this.lock(),this.flashProperty(i,"logging",null,this.unlock),i.map(function(r){return{commit:this.getCommit(r),order:e[r]}},this).sort(function(r,n){return r.order-n.order}).map(function(r){var n=r.commit;return n.id+" "+(n.message||"(no message)")},this)},setProperty:function(t,e){t.forEach(function(i){this.getCommit(i)[e]=!0},this)},unsetProperty:function(t,e){t.forEach(function(i){var r=this.getCommit(i);delete r[e]},this)},cherryPick:function(t,e){if(t.forEach(function(n){if(!this.getCommit(n))throw new Error("fatal: bad revision '"+n+"'")},this),e){if(e>2||e<1)throw new Error("Commit "+t[0]+" does not have parent "+e);var i=t.filter(function(n){var s=this.getCommit(n);return!s.parent||!s.parent2},this);if(i.length)throw new Error("mainline specified but "+i[0]+" is not a merge")}else{var r=t.filter(function(n){var s=this.getCommit(n);return s.parent&&s.parent2},this);if(r.length)throw new Error("cannot cherry-pick merge commit "+r[0]+" without specifying a mainline with -m")}e?t.forEach(function(n){var s=this.getCommit(n),o=s.message||"",a=this.getNonMainlineCommits(s.id,e);this.lock(),this.flashProperty(a,"cherryPicked",function(){this.commit({cherryPickSource:a},o);var c="cherry-pick: "+o;this.addReflogEntry("HEAD",this.getCommit("HEAD").id,c),this.currentBranch&&this.addReflogEntry(this.currentBranch,this.getCommit("HEAD").id,c)},this.unlock)},this):t.forEach(function(n){var s=this.getCommit(n),o=s.message||"";this.lock(),this.flashProperty([s.id],"cherryPicked",function(){this.commit({cherryPickSource:[s.id]},o);var a="cherry-pick: "+o;this.addReflogEntry("HEAD",this.getCommit("HEAD").id,a),this.currentBranch&&this.addReflogEntry(this.currentBranch,this.getCommit("HEAD").id,a)},this.unlock)},this)},getNonMainlineCommits:function(t,e){if(e===1)e=2;else if(e===2)e=1;else throw new Error("Mainline "+e+" isn't supported");var i=this.getAncestorSet(t,1),r=this.getAncestorSet(t,2),n=N(i,r);return Object.keys(n[e-1]).concat(t)},flashProperty:function(t,e,i,r){this.setProperty(t,e),this.renderCommits(),setTimeout((function(){i&&i.call(this),setTimeout((function(){this.unsetProperty(t,e),this.renderCommits(),r&&r.call(this)}).bind(this),500)}).bind(this),1e3)},getParents:function(t,e){var i,r=[];return t.id?i=t:i=this.getCommit(t),(!e||e===1)&&i.parent&&r.push(i.parent),(!e||e===2)&&i.parent2&&r.push(i.parent2),r},getAncestorSet:function(t,e){var i={},r=1;function n(s,o){var a=this.getParents(s,o);a.forEach(function(c){i[c]=r++,n.call(this,c)},this)}return n.call(this,t,e),i},getBranchList:function(){return this.commitData.reduce(function(t,e){return t.concat(e.tags.filter(function(i){return!i.match(/^\[.*\]$/)&&i!=="HEAD"}))},[]).map(function(t){return this.currentBranch&&t.toLowerCase()===this.currentBranch.toLowerCase()?"* "+t:"&nbsp; "+t},this)},branch:function(t,e){if(!t||t.trim()==="")throw new Error("You need to give a branch name.");if(t==="HEAD")throw new Error('You cannot name your branch "HEAD".');if(this.branches.indexOf(t)>-1)throw new Error('Branch "'+t+'" already exists.');var i=this.getCommit(e||"head");if(!i)throw new Error("fatal: Not a valid object name:'"+e+"'");return i.tags.push(t),this.renderTags(),this},tag:function(t){this.branch("["+t+"]")},deleteBranch:function(t){var e,i;if(!t||t.trim()==="")throw new Error("You need to give a branch name.");if(t===this.currentBranch)throw new Error("Cannot delete the currently checked-out branch.");if(e=this.branches.indexOf(t),e===-1)throw new Error("That branch doesn't exist.");this.branches.splice(e,1),i=this.getCommit(t),delete this.logs[t],e=i.tags.indexOf(t),e>-1&&i.tags.splice(e,1),this.renderTags()},checkout:function(t){var e=this.getCommit(t);if(!e)throw new Error("Cannot find commit: "+t);var i=this.getCircle("HEAD"),r=this.getCircle(e.id);i&&!i.empty()&&i.classed("checked-out",!1);var n=this.branches.indexOf(t)!==-1;return this._setCurrentBranch(n?t:null),this.moveTag("HEAD",e.id),this.renderTags(),r.classed("checked-out",!0),this},reset:function(t){var e=this.getCommit(t);if(!e)throw new Error("Cannot find ref: "+t);return this.currentBranch?(this.moveTag(this.currentBranch,e.id),this.checkout(this.currentBranch)):this.checkout(e.id),this},revert:function(t,e){if(t.forEach(function(n){if(!this.getCommit(n))throw new Error("fatal: bad revision '"+n+"'")},this),e){if(e>2||e<1)throw new Error("Commit "+t[0]+" does not have parent "+e);var i=t.filter(function(n){var s=this.getCommit(n);return!s.parent||!s.parent2},this);if(i.length)throw new Error("mainline specified but "+i[0]+" is not a merge")}else{var r=t.filter(function(n){var s=this.getCommit(n);return s.parent&&s.parent2},this);if(r.length)throw new Error("cannot revert merge commit "+r[0]+" without specifying a mainline with -m")}e?t.forEach(function(n){var s=this.getCommit(n),o=s.message||"",a=this.getNonMainlineCommits(s.id,e);this.lock(),this.flashProperty(a,"reverted",function(){this.commit({revertSource:a},"Revert "+s.id);var c="revert: "+o;this.addReflogEntry("HEAD",this.getCommit("HEAD").id,c),this.currentBranch&&this.addReflogEntry(this.currentBranch,this.getCommit("HEAD").id,c)},this.unlock)},this):t.forEach(function(n){var s=this.getCommit(n),o=s.message||"";this.lock(),this.flashProperty([s.id],"reverted",function(){this.commit({revertSource:[s.id]},"Revert "+s.id);var a="revert: "+o;this.addReflogEntry("HEAD",this.getCommit("HEAD").id,a),this.currentBranch&&this.addReflogEntry(this.currentBranch,this.getCommit("HEAD").id,a)},this.unlock)},this)},fastForward:function(t){var e=this.getCommit(t);this.currentBranch?(this.moveTag(this.currentBranch,e.id),this.checkout(this.currentBranch)):this.checkout(e.id)},isAncestorOf:function(t,e){var i=this.getCommit(e),r=this.getCommit(t);if(!r)return!1;if(i===r)return!0;var n=i.parent&&this.isAncestorOf(r.id,i.parent),s=i.parent2&&this.isAncestorOf(r.id,i.parent2);return n||s},merge:function(t,e){var i=this.getCommit(t),r=this.getCommit("HEAD");if(!i)throw new Error("Cannot find ref: "+t);if(r.id===i.id)throw new Error("Already up-to-date.");if(r.parent2===i.id)throw new Error("Already up-to-date.");if(this.isAncestorOf(i,r))throw new Error("Already up-to-date.");if(e===!0){for(var n=this.getCommit(i.parent);n.parent!==r.id;)n=this.getCommit(n.parent);n.isNoFFBranch=!0,this.commit({parent2:i.id,isNoFFCommit:!0},"Merge")}else{if(this.isAncestorOf(r.id,i.id))return this.fastForward(i),"Fast-Forward";this.commit({parent2:i.id},"Merge")}},rebase:function(t){var e=this.getCommit(t);if(!e)throw new Error("Cannot find commit "+t);this.branch("ORIG_HEAD");var i=this.getCommit("ORIG_HEAD"),r=this.currentBranch;r||i.id,this.checkout(e.id),this.addReflogEntry("HEAD",e.id,"rebase: checkout "+t);var n=this.getAncestorSet(t),s=this.getAncestorSet(i.id),o=N(n,s)[1],a=Object.keys(o).concat(i.id).sort(function(c,h){return o[h]-o[c]});this.lock(),setTimeout((function(){this.flashProperty(a,"rebased",function(){a.forEach(function(h){var f=this.getCommit(h);this.commit({rebased:!0,rebaseSource:h},f.message),this.addReflogEntry("HEAD",this.getCommit("HEAD").id,"rebase: "+(f.message||f.id))},this);var c=this.getCommit("HEAD");this.lock(),setTimeout((function(){this.deleteBranch("ORIG_HEAD"),r&&(this.moveTag(r,c.id),this.reset(r),this._setCurrentBranch(r),this.addReflogEntry("HEAD",this.getCommit("HEAD").id,"rebase finished: returning to refs/heads/"+r),this.addReflogEntry(r,c.id,"rebase finished: refs/heads/"+r+" onto "+e.id)),this.unsetProperty(a,"rebased"),this.unlock()}).bind(this),1e3)},this.unlock)}).bind(this),1e3)}};const K={title:"Free Explore",key:"free",message:"Have fun!",commitData:[{id:"e137e9b",tags:["main"],message:"first commit"}]},Z={title:"Free Explore with Remote",key:"free-remote",message:"Have fun!",commitData:[{id:"e137e9b",tags:["main","origin/main"],message:"first commit"}],originData:[{id:"e137e9b",tags:["main"],message:"first commit"}]},Q={title:"Upstream Changes",key:"upstream-changes",message:"Someone else has been working here!",currentBranch:"feature",commitData:[{id:"e137e9b",tags:[],message:"first commit",parent:"initial"},{id:"84c98fe",parent:"e137e9b",tags:["main","origin/main"]},{id:"1c016b6",parent:"e137e9b",tags:["feature","origin/feature","HEAD"]}],originData:[{id:"e137e9b",tags:[],message:"first commit",parent:"initial"},{id:"84c98fe",parent:"e137e9b",tags:["main","HEAD"]},{id:"1c016b6",parent:"e137e9b",tags:[]},{id:"fd0af32",tags:["feature"],parent:"1c016b6"}]},tt={title:"Rewritten Remote History",key:"rewritten-history",message:"Someone force-pushed and re-wrote history on the remote!",currentBranch:"feature",commitData:[{id:"e137e9b",tags:[],message:"first commit",parent:"initial",cx:50,cy:330,branchless:!1},{id:"84c98fe",parent:"e137e9b",tags:["main","origin/main"],cx:140,cy:330,branchless:!1},{id:"1c016b6",parent:"e137e9b",tags:[],cx:140,cy:240,branchless:!1},{id:"fd0af32",parent:"1c016b6",tags:[],cx:230,cy:240,branchless:!1},{id:"5041e4c",tags:["feature","origin/feature","HEAD"],parent:"fd0af32",cx:320,cy:240,branchless:!1}],originData:[{id:"e137e9b",tags:[],message:"first commit",parent:"initial",cx:50,cy:360,branchless:!1},{id:"84c98fe",parent:"e137e9b",tags:["main"],cx:140,cy:360,branchless:!1},{id:"1c016b6",parent:"e137e9b",tags:[],cx:140,cy:270,branchless:!1},{id:"fd0af32",tags:["feature","HEAD"],parent:"1c016b6",cx:230,cy:270,branchless:!1},{id:"5041e4c",tags:[],parent:"fd0af32",cx:320,cy:270,branchless:!0}]},et={title:"Revert",key:"revert",message:"Oops, let's revert some commits",commitData:[{id:"e137e9b",tags:[],message:"first commit",parent:"initial",cx:50,cy:330,branchless:!1},{id:"dd70cfe",tags:[],parent:"e137e9b",cx:140,cy:330,branchless:!1},{id:"2545b6f",tags:[],parent:"dd70cfe",cx:230,cy:330,branchless:!1},{id:"3d6ef16",tags:[],parent:"dd70cfe",cx:230,cy:240,branchless:!1},{id:"077415f",tags:["feature"],parent:"3d6ef16",cx:320,cy:240,branchless:!1},{parent2:"077415f",id:"8686fb6",tags:["main","HEAD"],message:"Merge",parent:"2545b6f",cx:410,cy:330,branchless:!1}]},it={title:"Cherry Pick",key:"cherry-pick",message:"Let's pick some commits",commitData:[{id:"e137e9b",tags:[],message:"first commit",parent:"initial",cx:50,cy:318,branchless:!1},{id:"790dd94",tags:[],parent:"e137e9b",cx:140,cy:318,branchless:!1},{id:"96e9ce7",tags:["[bugfix1]"],parent:"790dd94",cx:230,cy:318,branchless:!1},{id:"44db644",tags:[],parent:"96e9ce7",cx:320,cy:318,branchless:!1},{id:"06127d7",tags:[],parent:"44db644",cx:410,cy:318,branchless:!1},{id:"60c6c2c",tags:[],parent:"790dd94",cx:230,cy:228,branchless:!1},{id:"8f7c801",tags:["release","HEAD"],parent:"60c6c2c",cx:320,cy:228,branchless:!1},{id:"78ecb32",tags:[],parent:"44db644",cx:410,cy:228,branchless:!1},{id:"12e9bbb",tags:["bugfix2"],parent:"78ecb32",cx:500,cy:228,branchless:!1},{id:"e8ce346",tags:[],parent:"06127d7",cx:500,cy:318,branchless:!1},{parent2:"12e9bbb",id:"5749661",tags:["main"],message:"Merge",parent:"e8ce346",cx:590,cy:318,branchless:!1}]},E=[K,Z,Q,tt,et,it],k=typeof window<"u"&&window.d3||globalThis.d3,rt=typeof window<"u"&&window.yargsParser||globalThis.yargsParser;function b(t,e){var i=rt(t,e);return i._=i._.map(function(r){return""+r}),i}function U(t){this.historyView=t.historyView,this.originView=t.originView,this.initialMessage=t.initialMessage||"Enter git commands below.",this._commandHistory=[],this._currentCommand=-1,this._tempCommand="",this.rebaseConfig={},this.undoHistory=t.undoHistory||{pointer:0,stack:[{hv:this.historyView.serialize(),ov:this.originView&&this.originView.serialize()}]},this.mode="local",this.historyView.on("lock",this.lock.bind(this)),this.historyView.on("unlock",this.unlock.bind(this))}U.prototype={lock:function(){this.locked=!0},unlock:function(){this.locked=!1,this.createUndoSnapshot(!0)},createUndoSnapshot:function(t){var e={hv:this.historyView.serialize(),ov:this.originView&&this.originView.serialize()||"null"};t?this.undoHistory.stack[this.undoHistory.pointer]=e:(this.undoHistory.pointer++,this.undoHistory.stack.length=this.undoHistory.pointer,this.undoHistory.stack.push(e)),this.persist()},persist:function(){window.localStorage&&window.localStorage.setItem("git-viz-snapshot",JSON.stringify(this.undoHistory))},getRepoView:function(){if(this.mode==="local")return this.historyView;if(this.mode==="origin")return this.originView;throw new Error("invalid mode: "+this.mode)},changeMode:function(t){if(console.log(t),t==="local"&&this.historyView)this.mode="local";else if(t==="remote"&&this.originView)this.mode="origin";else throw new Error("invalid mode: "+t)},render:function(t){var e=this,i,r,n,s;i=t.append("div").classed("control-box",!0),s=i.append("select").classed("scenario-chooser",!0),E.forEach(function(o){var a=s.append("option").text(o.title).attr("value",o.key);window.location.hash==="#"+o.key&&a.attr("selected","selected")}),s.on("change",function(){if(!confirm("This will erase your current progress. Continue?"))return k.event.preventDefault(),k.event.stopPropagation(),s.node().value=window.location.hash.replace(/^#/,"")||E[0].key,!1;var o=window.location.hash,a=s.node(),c=a.options[a.selectedIndex].value;"#"+c!==o&&(window.location.hash=c)}),r=i.append("div").classed("log",!0),n=i.append("input").attr("type","text").classed("input",!0).attr("placeholder","enter git command"),r.on("click",function(){k.event.target===r.node()&&n.node().focus()}),setTimeout(function(){n.node().focus()}),n.on("keyup",function(){var o=k.event;switch(o.keyCode){case 13:if(this.value.trim()===""||e.locked)return;e._commandHistory.unshift(this.value),e._tempCommand="",e._currentCommand=-1,e.command(this.value),this.value="",o.stopImmediatePropagation();break;case 38:var a=e._commandHistory[e._currentCommand+1];e._currentCommand===-1&&(e._tempCommand=this.value),typeof a=="string"&&(e._currentCommand+=1,this.value=a,this.value=this.value),o.stopImmediatePropagation();break;case 40:var c=e._commandHistory[e._currentCommand-1];typeof c=="string"?(e._currentCommand-=1,this.value=c,this.value=this.value):(e._currentCommand=-1,this.value=e._tempCommand,this.value=this.value),o.stopImmediatePropagation();break;default:document.getElementById("last-command").textContent=document.querySelectorAll(".control-box .input")[0].value}}),this.container=i,this.terminalOutput=r,this.input=n,this.info(this.initialMessage)},destroy:function(){this.terminalOutput.remove(),this.input.remove(),this.container.remove();for(var t in this)this.hasOwnProperty(t)&&(this[t]=null)},_scrollToBottom:function(){var t=this.terminalOutput.node();t.scrollTop=t.scrollHeight},command:function(t){if(t=t.trim(),t!==""){if(document.getElementById("last-command").textContent=t,t.trim()==="help"||t.trim()==="help()"){this.info("pres() = Turn on presenter mode"),this.info("undo = Undo the last git command"),this.info("redo = Redo the last undone git command"),this.info("mode = Change mode (`local` or `remote`)"),this.info("clear = Clear the history pane and reset the visualization"),this.info(),this.info("Available Git Commands:"),this.info("`git branch`"),this.info("`git checkout`"),this.info("`git switch`"),this.info("`git cherry_pick`"),this.info("`git commit`"),this.info("`git fetch`"),this.info("`git log`"),this.info("`git merge`"),this.info("`git pull`"),this.info("`git push`"),this.info("`git rebase`"),this.info("`git reflog`"),this.info("`git reset`"),this.info("`git rev_parse`"),this.info("`git revert`"),this.info("`git tag`");return}if(t==="pres()"){window.pres();return}if(t.toLowerCase().indexOf("mode ")===0){var e=t.split(" ").pop();this.changeMode(e);return}if(t.toLowerCase()==="undo"){var i=this.undoHistory.pointer-1,r=this.undoHistory.stack[i];r?(this.historyView.deserialize(r.hv),this.originView&&this.originView.deserialize(r.ov),this.undoHistory.pointer=i):this.error("Nothing to undo"),this.persist(),this.terminalOutput.append("div").classed("command-entry",!0).html(t),this._scrollToBottom();return}if(t.toLowerCase()==="redo"){var i=this.undoHistory.pointer+1,r=this.undoHistory.stack[i];r?(this.historyView.deserialize(r.hv),this.originView&&this.originView.deserialize(r.ov),this.undoHistory.pointer=i):this.error("Nothing to redo"),this.persist(),this.terminalOutput.append("div").classed("command-entry",!0).html(t),this._scrollToBottom();return}if(t.toLowerCase()==="clear"){window.resetVis();return}var n=t.split(" ");if(this.terminalOutput.append("div").classed("command-entry",!0).html(t),this._scrollToBottom(),n[0]!=="git")return this.error();var s=n[1].replace(/-/g,"_"),o=n.slice(2),a=o.join(" "),c=b(a);try{typeof this[s]=="function"?(this[s](o,c,a),this.createUndoSnapshot()):this.error()}catch(f){console.error(f.stack);var h=f&&f.message?f.message:null;this.error(h)}}},info:function(t){this.terminalOutput.append("div").classed("info",!0).html(t),this._scrollToBottom()},error:function(t){t=t||"I don't understand that.",this.terminalOutput.append("div").classed("error",!0).html(t),this._scrollToBottom()},transact:function(t,e){var i=this.getRepoView().getCommit("HEAD"),r=this.getRepoView().currentBranch,n=r||i.id;t.call(this);var s=this.getRepoView().getCommit("HEAD"),o=this.getRepoView().currentBranch,a=o||s.id;e.call(this,{commit:i,branch:r,ref:n},{commit:s,branch:o,ref:a})},commit:function(t,e,i){e=b(i,{boolean:["amend"],string:["m"]});var r="";this.transact(function(){e.amend?this.getRepoView().amendCommit(e.m||this.getRepoView().getCommit("head").message):this.getRepoView().commit(null,e.m)},function(n,s){var o="commit: "+r;this.getRepoView().addReflogEntry("HEAD",s.commit.id,o),n.branch&&this.getRepoView().addReflogEntry(n.branch,s.commit.id,o)})},log:function(t){if(t.length>1)return this.error("'git log' can take at most one argument in this tool");var e=this.getRepoView().getLogEntries(t[0]||"head").map(function(i){return"<span class='log-entry'>&gt; "+i+"</span>"}).join("");this.info(e)},rev_parse:function(t){t.forEach(function(e){this.info(this.getRepoView().revparse(e))},this)},cherry_pick:function(t,e,i){if(e=b(i,{number:["m"]}),!e._.length){this.error("You must specify one or more commits to cherry-pick");return}if(e.m!==void 0&&isNaN(e.m)){this.error("switch 'm' expects a numerical value");return}this.getRepoView().cherryPick(e._,e.m)},branch:function(t,e,i){e=b(i,{alias:{delete:["d"],remote:["r"],all:["a"]},boolean:["a","r"]});var r=e._[0],n=e._[1]||"head";if(e.delete)return this.getRepoView().deleteBranch(e.delete);if(e._[2])return this.error("Incorrect usage - supplied too many arguments");if(!r){var s;return e.remote?s=this.getRepoView().getBranchList().filter(function(o){return o.indexOf("&nbsp; origin/")===0}).join("<br>"):e.all?s=this.getRepoView().getBranchList().join("<br>"):s=this.getRepoView().getBranchList().filter(function(o){return o.indexOf("&nbsp; origin/")!==0}).join("<br>"),this.info(s)}this.transact(function(){this.getRepoView().branch(r,n)},function(o,a){var c=this.getRepoView().getCommit(r),h="branch: created from "+o.ref;this.getRepoView().addReflogEntry(r,c.id,h)})},switch:function(t,e,i){var r=b(i||"",{alias:{create:["c"]},string:["create","c"]}),n=r._?r._.slice():[],s={_:n.slice()},o=r.create!==void 0?r.create:r.c;Array.isArray(o)&&(o=o[o.length-1]),o&&(s.b=o),this.checkout(n,s)},checkout:function(t,e){e.b&&(e._[0]?this.branch(null,null,e.b+" "+e._[0]):this.branch(null,null,e.b));var i=e.b||e._[0];this.transact(function(){this.getRepoView().checkout(i)},function(r,n){this.getRepoView().addReflogEntry("HEAD",n.commit.id,"checkout: moving from "+r.ref+" to "+i)})},tag:function(t){if(t.length<1){this.info("You need to give a tag name. Normally if you don't give a name, this command will list your local tags on the screen.");return}for(;t.length>0;){var e=t.shift();try{this.getRepoView().tag(e)}catch(i){if(i.message.indexOf("already exists")===-1)throw new Error(i.message)}}},doReset:function(t){this.transact(function(){this.getRepoView().reset(t)},function(e,i){var r="reset: moving to "+t;this.getRepoView().addReflogEntry("HEAD",i.commit.id,r),e.branch&&this.getRepoView().addReflogEntry(e.branch,i.commit.id,r)})},reset:function(t){for(;t.length>0;){var e=t.shift();switch(e){case"--soft":this.info('The "--soft" flag works in real git, but I am unable to show you how it works in this demo. So I am just going to show you what "--hard" looks like instead.');break;case"--mixed":this.info('The "--mixed" flag works in real git, but I am unable to show you how it works in this demo. So I am just going to show you what "--hard" looks like instead.');break;case"--hard":this.doReset(t.join(" ")),t.length=0;break;default:var i=[e].concat(t);t.length=0,this.info('Assuming "--hard".'),this.doReset(i.join(" "))}}},clean:function(t){this.info("Deleting all of your untracked files...")},revert:function(t,e,i){if(e=b(i,{number:["m"]}),!e._.length){this.error("You must specify a commit to revert");return}if(e.m!==void 0&&isNaN(e.m)){this.error("switch 'm' expects a numerical value");return}this.transact(function(){this.getRepoView().revert(e._,e.m)},function(r,n){var s="revert: "+r.commit.message||r.commit.id;this.getRepoView().addReflogEntry("HEAD",n.commit.id,s),r.branch&&this.getRepoView().addReflogEntry(r.branch,n.commit.id,s)})},merge:function(t){var e=!1,i=t[0],r;t.length===2&&(t[0]==="--no-ff"?(e=!0,i=t[1]):t[1]==="--no-ff"?(e=!0,i=t[0]):this.info("This demo only supports the --no-ff switch..")),this.transact(function(){r=this.getRepoView().merge(i,e),r==="Fast-Forward"&&this.info("You have performed a fast-forward merge.")},function(n,s){var o="merge "+i+": ";r==="Fast-Forward"?o+="Fast-forward":o+="Merge made by the 'recursive' strategy.",this.getRepoView().addReflogEntry("HEAD",s.commit.id,o),n.branch&&this.getRepoView().addReflogEntry(n.branch,s.commit.id,o)})},rebase:function(t){var e=t.shift(),i=this.getRepoView().rebase(e);i==="Fast-Forward"&&this.info("Fast-forwarded to "+e+".")},fetch:function(){if(this.mode!=="local")throw new Error("can only fetch from local");if(!this.originView)throw new Error("There is no remote server to fetch from.");var t=this.originView,e=this.historyView,i=/^origin\/([^\/]+)$/,r,n,s,o={},a=[],c=[],h,f="";for(r=0;r<e.branches.length;r++)n=i.exec(e.branches[r]),n&&(o[n[1]]=0);function l(m,v){var y=e.getCommit(m.id)===null;y&&m.id&&(a.indexOf(m.id)===-1&&(c.unshift(m),a.unshift(m.id)),o[v]+=1,m.parent&&l(t.getCommit(m.parent),v),m.parent2&&l(t.getCommit(m.parent2),v))}for(s in o)t.branches.indexOf(s)>-1&&l(t.getCommit(s),s);for(var d=0;d<c.length;d++)h=c[d],e.commitData.push({id:h.id,parent:h.parent,parent2:h.parent2,tags:[]});for(s in o){if(t.branches.indexOf(s)>-1){var p=t.getCommit(s).id;e.moveTag("origin/"+s,p)}f+="Fetched "+o[s]+" commits on "+s+".</br>"}this.info(f),e.renderCommits()},pull:function(t){if(this.mode!=="local")throw new Error("can only pull from local");var e=this,i=this.historyView,r=i.currentBranch,n="origin/"+r,s=!1;if(this.fetch(),!r)throw new Error("You are not currently on a branch.");if(i.branches.indexOf(n)===-1)throw new Error("Current branch is not set up for pulling.");this.lock(),setTimeout((function(){try{t[0]==="--rebase"||e.rebaseConfig[r]==="true"?s=i.rebase(n)==="Fast-Forward":s=i.merge(n)==="Fast-Forward"}catch(o){e.error(o.message)}finally{this.unlock()}s&&e.info("Fast-forwarded to "+n+".")}).bind(this),750)},push:function(t,e,i){var r=b(i,{alias:{force:["f"],upstream:["u"]},boolean:["f","u"]});if(this.mode!=="local")throw new Error("can only push from local");var n=this.historyView,s=r._[0]||"origin",o=this[s+"View"],a=r._[1],c=n.currentBranch,h=n.currentBranch,f,l,d,p,m=[],v=[];if(s==="history")throw new Error(`Sorry, you can't have a remote named "history" in this example.`);if(!o)throw new Error('There is no remote server named "'+s+'".');if(o.branches.indexOf(h)===-1&&o.branch(h,"e137e9b"),a&&(a=/^([^:]*)(:?)(.*)$/.exec(a),a[1]&&(c=a[1]),a[2]===":"&&(h=a[3])),n.branches.indexOf(c)===-1)throw new Error("Local ref: "+c+" does not exist.");if(!h)throw new Error("No remote branch was specified to push to.");if(f=n.getCommit(c),l=o.getCommit(h),d=function g(u){var w=o.getCommit(u.id)!==null;!w&&m.indexOf(u.id)===-1&&(m.push(u.id),v.push(Object.assign({},u,{tags:[]})),u.parent&&g(n.getCommit(u.parent)),u.parent2&&g(n.getCommit(u.parent2)))},l&&o.branches.indexOf(h)>-1){if(!n.isAncestorOf(l.id,f.id)&&!r.f)throw new Error("Push rejected. Non fast-forward. Try pulling first");if(p=f.id===l.id,p)return this.info("Everything up-to-date.");if(!r.f)d(f),o.commitData=o.commitData.concat(v);else{var y=JSON.parse(JSON.stringify(n.commitData));y.forEach(function(g){var u=g.tags.indexOf("origin/"+c);u>-1&&g.tags.splice(u,1)}),o.commitData=y,this.info("forced update")}o.moveTag(h,f.id),n.moveTag("origin/"+c,c),o.renderCommits(),n.renderTags()}},config:function(t){var e=t.shift().split(".");e[0]==="branch"&&e[2]==="rebase"&&(this.rebase[e[1]]=t.pop())},reflog:function(t){var e=(function(s){return this.getRepoView().logs[s.toLowerCase()]}).bind(this),i="",r="show";if(t.length===0)i="HEAD";else if(t.length===1)i=t[0].trim(),(i==="show"||i==="expire"||i==="delete"||i==="exists")&&(r=i,i="HEAD");else if(t.length===2)r=t[0],i=t[1];else{this.error("'git reflog' can take at most two arguments in this tool");return}if(!i){this.error("No ref specified");return}if(r==="exists")e(i)?this.info("Reflog for ref "+i+" exists"):this.error("Reflog for ref "+i+" does not exist");else if(r==="show"){var n=this.getRepoView().getReflogEntries(i);this.info(n.map(function(s){return"<span class='reflog-entry'>&gt; "+s+"</span>"}).join(""))}else(r==="expire"||r==="delete")&&this.info("Real git reflog supports the '"+r+"' subcommand but this tool only supports 'show' and 'exists'")}};const nt=typeof window<"u"&&window.d3||globalThis.d3;function st(t){if(t!==void 0)return t;if(typeof window<"u")return window}function ot({HistoryView:t=H,ControlBox:e=U,d3:i=nt,windowGlobal:r}={}){const n="ExplainGit",s=[],o=st(r);function a(f){const l=Object.create(f),d=n+l.name,p=d+"-Container",m=i.select("#"+p),v=m.select(".playground-container");let y,g=null,u;m.style("display","block"),l.name=d,l.savedState=l.hvSavedState,y=new t(l),o&&(o.hv=y),l.originData&&(g=new t({name:d+"-Origin",width:300,height:400,commitRadius:l.commitRadius,remoteName:"origin",commitData:l.originData,savedState:l.ovSavedState}),g.render(v),o&&(o.ov=g)),u=new e({historyView:y,originView:g,initialMessage:l.initialMessage,undoHistory:l.undoHistory}),o&&(o.cb=u),u.render(v),y.render(v),s.push({hv:y,cb:u,container:m})}function c(){for(let f=0;f<s.length;f+=1){const l=s[f];l.hv.destroy(),l.cb.destroy(),l.container.style("display","none")}s.length=0,i.selectAll("a.openswitch").classed("selected",!1)}const h={HistoryView:t,ControlBox:e,generateId:t.generateId,open:a,reset:c};return o&&(o.explainGit=h),h}const F=ot();String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")});Array.isArray||(Array.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"});Array.prototype.indexOf||(Array.prototype.indexOf=function(e){if(this==null)throw new TypeError;const i=Object(this),r=i.length>>>0;if(r===0)return-1;let n=0;if(arguments.length>1&&(n=Number(arguments[1]),Number.isNaN(n)?n=0:n!==0&&n!==1/0&&n!==-1/0&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),n>=r)return-1;let s=n>=0?n:Math.max(r-Math.abs(n),0);for(;s<r;s+=1)if(s in i&&i[s]===e)return s;return-1});const X=()=>typeof window<"u"?window:void 0;function at(t){const e=X();e&&(e.document.readyState!=="loading"?t():e.document.addEventListener("DOMContentLoaded",t))}function ct(t){t&&t.localStorage&&t.localStorage.removeItem("git-viz-snapshot")}function ht(t){t&&typeof t.$=="function"&&t.$(".svg-container.remote-container").remove()}function I(t){ct(t),ht(t)}function z(t){return t.replace(/^#/,"")}function j(t,e){return t.find(i=>i.key===e)}function ft(t){return JSON.parse(JSON.stringify(t))}function D(t){return typeof t!="string"?t:t==="master"?"main":t==="origin/master"?"origin/main":/^refs\/(heads|remotes\/origin)\/master$/.test(t)?t.replace(/master$/,"main"):t}function lt(t){return typeof t!="string"?t:t.replace(/origin\/master/g,"origin/main").replace(/\bmaster\b/g,"main")}function Y(t){if(typeof t!="string")return t;let e;try{e=JSON.parse(t)}catch{return t}if(Array.isArray(e.commitData)&&(e.commitData=e.commitData.map(i=>(i&&Array.isArray(i.tags)&&(i.tags=i.tags.map(D)),i))),Array.isArray(e.branches)&&(e.branches=e.branches.map(D)),e.currentBranch=D(e.currentBranch),e.logs&&typeof e.logs=="object"){const i={};Object.keys(e.logs).forEach(r=>{const n=D(r),s=e.logs[r];i[n]=Array.isArray(s)?s.map(o=>{if(!o||typeof o!="object")return o;const a={...o};return a.reason=lt(a.reason),a}):s}),e.logs=i}return JSON.stringify(e)}function ut(t){if(!t||typeof t!="object")return t;const e={...t};return e.stack=Array.isArray(t.stack)?t.stack.map(i=>{if(!i||typeof i!="object")return i;const r={...i};return typeof r.hv=="string"&&(r.hv=Y(r.hv)),typeof r.ov=="string"&&(r.ov=Y(r.ov)),r}):t.stack,e}function mt(){const t=X();if(!t)return;let e=j(E,z(t.location.hash))||E[0];function i(){F.reset();let r=null;if(t.localStorage)try{const s=JSON.parse(t.localStorage.getItem("git-viz-snapshot")||"null");r=ut(s),r&&t.localStorage.setItem("git-viz-snapshot",JSON.stringify(r))}catch{r=null}const n=Object.assign(ft(e),{name:"Zen",height:"100%",initialMessage:e.message,undoHistory:r,hvSavedState:r&&r.stack[r.pointer].hv,ovSavedState:r&&r.stack[r.pointer].ov});F.open(n)}t.onhashchange=function(){const n=j(E,z(t.location.hash))||e;if(n){e=n;const s=t.document.getElementById("last-command");s&&(s.textContent=""),I(t),i()}},t.resetVis=function(){t.confirm("This will reset your visualization. Are you sure?")&&(I(t),i())},t.pres=function(){const n=t.document.getElementById("last-command");n&&(n.style.display="block")},at(()=>{i()})}mt();
